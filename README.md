# –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python-–ø–∞–∫–µ—Ç–æ–≤ (–í–∞—Ä–∏–∞–Ω—Ç ‚Ññ7)

–ü—Ä–æ–µ–∫—Ç —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π Python-–ø–∞–∫–µ—Ç–æ–≤ (pip), **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É—è –º–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–∞–∫–µ—Ç–æ–≤**, –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è–º –≤–∞—Ä–∏–∞–Ω—Ç–∞ ‚Ññ7.

–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:

- —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –∏–∑ CSV  
- –ø–æ–ª—É—á–µ–Ω–∏–µ **–ø—Ä—è–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π** –∑–∞–¥–∞–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –ø–∞–∫–µ—Ç–∞ —Å PyPI  
- –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ **—Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∞** –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  
- DFS **–±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏**  
- –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ü–∏–∫–ª–æ–≤  
- —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º —Å –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–º –≥—Ä–∞—Ñ–æ–º  
- –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ **Graphviz (DOT)**  
- –≤—ã–≤–æ–¥ —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  

---

# üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
depviz_project/
‚îú‚îÄ depviz_cli.py
‚îú‚îÄ README.md
‚îú‚îÄ src/
‚îÇ  ‚îî‚îÄ depviz/
‚îÇ      ‚îú‚îÄ __init__.py
‚îÇ      ‚îú‚îÄ cli.py
‚îÇ      ‚îú‚îÄ config.py
‚îÇ      ‚îú‚îÄ errors.py
‚îÇ      ‚îú‚îÄ graph.py
‚îÇ      ‚îú‚îÄ parser.py
‚îÇ      ‚îú‚îÄ pypi_client.py
‚îÇ      ‚îú‚îÄ test_repo.py
‚îÇ      ‚îî‚îÄ visualize.py
‚îî‚îÄ samples/
   ‚îú‚îÄ configs/
   ‚îÇ   ‚îú‚îÄ flask.csv
   ‚îÇ   ‚îú‚îÄ httpx.csv
   ‚îÇ   ‚îú‚îÄ fastapi.csv
   ‚îÇ   ‚îú‚îÄ test_diamond.csv
   ‚îÇ   ‚îî‚îÄ test_cycle.csv
   ‚îî‚îÄ test_repo_cases/
       ‚îú‚îÄ diamond.txt
       ‚îú‚îÄ cycle.txt
       ‚îî‚îÄ simple.txt 
```

---

# üìò –û–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ (–ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ –≤–∞—Ä–∏–∞–Ω—Ç—É ‚Ññ7)

---

## **–≠—Ç–∞–ø 1 ‚Äî –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (CSV)**

–§–æ—Ä–º–∞—Ç CSV:

```
–∫–ª—é—á,–∑–Ω–∞—á–µ–Ω–∏–µ
```

–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è:

- `package_name`
- `repository_url` ‚Äî —Ç–æ–ª—å–∫–æ PyPI (GitHub –∑–∞–ø—Ä–µ—â—ë–Ω!)
- `mode` ‚Äî `real` –∏–ª–∏ `test`
- `version` ‚Äî –≤–µ—Ä—Å–∏—è –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º–æ–≥–æ –ø–∞–∫–µ—Ç–∞

### –ö–æ–º–∞–Ω–¥–∞:

```bash
python depviz_cli.py --config samples/configs/flask.csv --stage 1
```

### –†–µ–∑—É–ª—å—Ç–∞—Ç:

- –≤—ã–≤–æ–¥ –∫–ª—é—á–µ–π –∏ –∑–Ω–∞—á–µ–Ω–∏–π  
- –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∏–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤  

---

## **–≠—Ç–∞–ø 2 ‚Äî –°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö: –ø—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PyPI API:

- `https://pypi.org/pypi/<pkg>/<version>/json`
- –∏–∑ –ø–æ–ª—è `requires_dist`
- fallback: —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ `.whl`/`.tar.gz` ‚Üí —á—Ç–µ–Ω–∏–µ `METADATA`

**–í–∞–∂–Ω–æ:**  
–ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GitHub (–ø–æ –∑–∞–¥–∞–Ω–∏—é).  
–ù–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è pip/poetry/importlib ‚Äî —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –±–∏–±–ª–∏–æ—Ç–µ–∫–∞.

### –ö–æ–º–∞–Ω–¥–∞:

```bash
python depviz_cli.py --config samples/configs/flask.csv --stage 2
```

–í—ã–≤–æ–¥–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ –ø—Ä—è–º—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

---

## **–≠—Ç–∞–ø 3 ‚Äî –ü–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (DFS –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏)**

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:

- DFS **—Å—Ç—Ä–æ–≥–æ –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏**  
- —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ–µ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥—Ä–∞—Ñ–∞  
- –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ü–∏–∫–ª–æ–≤  
- —Ä–∞–±–æ—Ç–∞ –≤ —Ä–µ–∂–∏–º–∞—Ö:  
  - `real`: PyPI  
  - `test`: –ª–æ–∫–∞–ª—å–Ω—ã–π –≥—Ä–∞—Ñ  

### –¢–µ—Å—Ç–æ–≤—ã–π –≥—Ä–∞—Ñ:

```bash
python depviz_cli.py --config samples/configs/test_diamond.csv --stage 3
```

### –†–µ–∞–ª—å–Ω—ã–π –ø–∞–∫–µ—Ç:

```bash
python depviz_cli.py --config samples/configs/flask.csv --stage 3
```

### –ë—ã—Å—Ç—Ä—ã–π —Ä–µ–∂–∏–º (—Ç–æ–ª—å–∫–æ –ø—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏):

```bash
python depviz_cli.py --config samples/configs/flask.csv --stage 3 --direct-only
```

---

## **–≠—Ç–∞–ø 4 ‚Äî –ü–æ—Ä—è–¥–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

–ê–ª–≥–æ—Ä–∏—Ç–º: **—Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (Kahn)**.

–ï—Å–ª–∏ –≥—Ä–∞—Ñ —Å–æ–¥–µ—Ä–∂–∏—Ç —Ü–∏–∫–ª—ã ‚Äî –≤—ã–≤–æ–¥—è—Ç—Å—è –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è.

### –ö–æ–º–∞–Ω–¥–∞:

```bash
python depviz_cli.py --config samples/configs/test_cycle.csv --stage 4 --show-install-order
```

---

## **–≠—Ç–∞–ø 5 ‚Äî –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è (Graphviz DOT)**

–í—ã–¥–∞—ë—Ç—Å—è –≤–∞–ª–∏–¥–Ω—ã–π –≥—Ä–∞—Ñ:

```
digraph DEP {
  rankdir=LR;
  node [shape=box];
  "A" -> "B";
  "A" -> "C";
}
```

### –¢–µ—Å—Ç–æ–≤–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è:

```bash
python depviz_cli.py --config samples/configs/test_diamond.csv --stage 5
```

### –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ dot —Ñ–∞–π–ª:

```bash
python depviz_cli.py --config samples/configs/flask.csv --stage 5 > graph.dot
dot -Tpng graph.dot -o graph.png
```

---

# üìò –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –º–æ–¥—É–ª–µ–π –∏ —Ñ—É–Ω–∫—Ü–∏–π

---

## **üìå config.py ‚Äî —á—Ç–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**

### –§—É–Ω–∫—Ü–∏–∏:

### `load_config(path)`
–ß–∏—Ç–∞–µ—Ç CSV, –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–ª—è, –∑–∞–ø—Ä–µ—â–∞–µ—Ç URL —Å GitHub.  
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –æ–±—ä–µ–∫—Ç `Config`.

### `print_config(cfg)`
–ü–µ—á–∞—Ç–∞–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ `–∫–ª—é—á=–∑–Ω–∞—á–µ–Ω–∏–µ`.

---

## **üìå pypi_client.py ‚Äî —Ä–∞–±–æ—Ç–∞ —Å PyPI**

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

#### `get_json_for_version(name, version)`
–ü–æ–ª—É—á–∞–µ—Ç JSON –ø–æ URL:
```
https://pypi.org/pypi/<pkg>/<version>/json
```

#### `get_direct_dependencies_for_version(name, version)`
–ü–∞—Ä—Å–∏—Ç:
- `requires_dist`
- –∏–ª–∏, –µ—Å–ª–∏ –Ω–µ—Ç, –∏–∑–≤–ª–µ–∫–∞–µ—Ç METADATA –∏–∑ –∞—Ä—Ö–∏–≤–∞

–ú–æ–¥—É–ª—å **–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pip**, —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏:

- `urllib.request`
- `zipfile`
- `tarfile`

---

## **üìå parser.py ‚Äî —Ä–∞–∑–±–æ—Ä Requires-Dist**

–§—É–Ω–∫—Ü–∏—è:

### `parse_requires_dist(str)`
–ü–æ–¥–¥–µ—Ä–∂–∫–∞:

- –∏–º–µ–Ω–∏ –ø–∞–∫–µ—Ç–∞  
- –≤–µ—Ä—Å–∏–∏  
- –º–∞—Ä–∫–µ—Ä–æ–≤ —É—Å–ª–æ–≤–∏–π  
- extras  

---

## **üìå graph.py ‚Äî –≥—Ä–∞—Ñ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**

–°—Ç—Ä—É–∫—Ç—É—Ä–∞:

- `adj: Dict[str, Set[str]]` ‚Äî —Å–ø–∏—Å–æ–∫ —Å–º–µ–∂–Ω–æ—Å—Ç–∏  
- `nodes` ‚Äî –≤—Å–µ –≤–µ—Ä—à–∏–Ω—ã  
- `cycles` ‚Äî –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã  

–ê–ª–≥–æ—Ä–∏—Ç–º—ã:

### `build_real(...)`
–°—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ –ø–æ PyPI —Å —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω–æ—Å—Ç—å—é.

### `build_test(...)`
–°—Ç—Ä–æ–∏—Ç –≥—Ä–∞—Ñ –∏–∑ —Ñ–∞–π–ª–∞.

### `install_order()`
–¢–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–∞–ª–≥–æ—Ä–∏—Ç–º –ö–∞–Ω–∞).

### `direct_deps()`
–ü—Ä—è–º—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏.

---

## **üìå test_repo.py ‚Äî —Ç–µ—Å—Ç–æ–≤—ã–µ –≥—Ä–∞—Ñ—ã**

–ü—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–∞—Ç:

```
A: B C
B: D
C: D
```

–§—É–Ω–∫—Ü–∏—è:

### `load_test_repo(path)`
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å –≥—Ä–∞—Ñ–∞.

---

## **üìå visualize.py ‚Äî Graphviz DOT**

–§—É–Ω–∫—Ü–∏—è:

### `to_dot(graph, root)`
–°–æ–∑–¥–∞—ë—Ç —Ç–µ–∫—Å—Ç–æ–≤–æ–µ DOT-–æ–ø–∏—Å–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∞.

---

## **üìå cli.py ‚Äî –ö–æ–º–∞–Ω–¥–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**

–û—Ç–≤–µ—á–∞–µ—Ç –∑–∞:

- —Ä–∞–∑–±–æ—Ä –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤  
- –≤—ã–∑–æ–≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö —ç—Ç–∞–ø–æ–≤  
- –≤—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤  

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ–ª–∞–≥–∏:

- `--stage`  
- `--direct-only`  
- `--show-install-order`  
- `--config`  

---

# üìå –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –≤–∞—Ä–∏–∞–Ω—Ç—É ‚Ññ7**, –≤–∫–ª—é—á–∞–µ—Ç:

‚úî —Ä–∞–±–æ—Ç—É —Å PyPI  
‚úî —Ç—Ä–∞–Ω–∑–∏—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π  
‚úî DFS –±–µ–∑ —Ä–µ–∫—É—Ä—Å–∏–∏  
‚úî —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º  
‚úî DOT-–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é  
‚úî —Ç–æ–ø–æ–ª–æ–≥–∏—á–µ—Å–∫—É—é —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫—É
